# Анализ влияния изображений на успешность товаров

## Описание проекта

Этот проект направлен на исследование влияния визуальных характеристик товаров (изображений) на их успешность на маркетплейсе. В качестве прокси-метрики успешности использовалась комбинация количества отзывов и рейтинга товара.

## Структура репозитория
``` bash
.
├── amazon_images          # Папка с изображениями товаров
├── analysis.ipynb         # Основной ноутбук с анализом
├── downloading.ipynb      # Ноутбук для загрузки датасета
├── final_dataset.csv      # Табличные данные
└── README.md
```

## Особенности датасета

Изначально планировалось использовать датасет Fashion Product Images с Kaggle, но он был отклонен по следующим причинам:
- Сильный дисбаланс в рейтингах (значения 9-11 составляют всего 0.11% выборки)
- Недостаточное количество данных о рейтингах для значимого анализа

Вместо этого был использован **Amazon Product Dataset**, который содержит:
- 3403 товара с полной информацией
- Рейтинги от 0 до 5
- Количество отзывов
- Изображения товаров
- Дополнительные атрибуты (категория, продажи и др.)

Важное ограничение: большинство изображений представляют собой обложки книг, журналов, фильмов и CD-дисков, что сужает сфе исследования до этих категорий товаров.

## Методология

### 1. Подготовка данных
- Очистка и предобработка данных
- Создание бинарной целевой переменной `target`:
  - `success_score = log(reviews_total + 1) * reviews_avg_rating`
  - Топ-20% товаров по success_score помечены как успешные (target=1)
  - Остальные 80% - неуспешные (target=0)

### 2. Извлечение признаков
**Визуальные признаки:**
- Использована предобученная ResNet18
- Извлечены эмбеддинги размерностью 512 для каждого изображения
- Для отсутствующих изображений использованы нулевые векторы

**Табличные признаки:**
- Числовые признаки: `salesrank` (нормализованы)
- Категориальные признаки: `group` (one-hot encoding)
- Текстовые эмбеддинги для категорий с помощью SentenceTransformer

### 3. Построение моделей
Использован CatBoostClassifier с регуляризацией для борьбы с переобучением. Сравнивались три подхода:
1. Только табличные признаки
2. Только эмбеддинги изображений
3. Комбинированные признаки

### 4. Кластеризация
Проведена кластеризация эмбеддингов изображений с помощью KMeans для выявления визуальных паттернов успешных товаров.

## Результаты

### Метрики качества моделей:
| Модель | ROC-AUC | F1-Score |
|--------|---------|----------|
| Табличные признаки | 0.825 | 0.574 |
| Эмбеддинги изображений | 0.614 | 0.351 |
| Комбинированные признаки | 0.825 | 0.557 |

### Кластеризация:
- Оптимальное количество кластеров: 4
- Не выявлено значимой разницы в доле успешных товаров между кластерами
- Визуальный анализ не показал четких паттернов успешности

## Выводы

### Влияние изображений:
Добавление визуальных признаков **не улучшило** качество модели:
- Модель на табличных данных показала наилучшие результаты
- Эмбеддинги изображений сами по себе показали низкое качество
- Комбинированный подход не дал значимого улучшения

### Возможные причины:
1. **Особенности датасета**: изображения являются в основном обложками, которые могут не нести решающей информации для потребительского выбора
2. **Дисбаланс классов**: только 20% товаров помечены как успешные
3. **Ограничения модели**: возможно, требуется более сложная архитектура или дообучение

### Рекомендации по улучшению:
1. Использование техник борьбы с дисбалансом (SMOTE, подбор class_weights)
2. Эксперименты с другими моделями (нейронные сети, ансамбли)
3. Использование более современных методов обработки изображений (CLIP, трансформеры)
4. Сбор более сбалансированного датасета с разнообразными изображениями


## Заключение
Исследование показало, что для данного типа товаров (книги, журналы, медиа) визуальные характеристики не являются определяющим фактором успешности. Основную предсказательную силу имеют табличные признаки, визуальные характеристики менее важны по сравнению с другими факторами (автор, содержание, жанр) для данной категории товаров. Для товаров, где визуальная составляющая более важна (одежда, аксессуары), результаты могут отличаться.
